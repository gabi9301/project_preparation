Section10. Effect, Reducers & Context

---useEffect hook------------------------------------------------------------------------------------------------

- Working with (Side) effects
- Managing more complex state with reducers
- Managing app-wide or component-wide state with context

React가 수행하는 주요 역할은 UI 렌더링과 사용자의 입력에 대응하는 것
(ex. useState(), Hook, Props etc)



Side Effects는 그 외의 역할을 의미한다.
(브라우저 스토리지에 데이터를 저장하거나 백엔드 서버에 Http 요청을 보내거나 타이머를 설정하는 등을 포함) 
그리고 해당 역할들은 컴포넌트 함수 밖에서 실행되어야 한다.
Http 요청을 예로 들자면 만약 이 과정이 렌더링 함수 내에서 실행될 경우
함수가 실행될 때마다 Http 요청을 보내게되고 이에 대한 응답으로 컴포넌트의 state가 변화된다면 다시 그에 따라 새로운 렌더링을 위해 해당 함수가 재실행되는 무한루프가 만들어질수도 있다.

그러므로 Side Effects를 다룰 땐 useEffect() Hook을 사용한다.

useEffect(() => { ... }, [ dependencies ]);

해당 Hook의 두 가지 인자는 'dependencies 배열'와 'dependencies가 바뀔 때마다 실행되는 함수' 이다. (side effect 코드는 함수 쪽에 작성한다.)
해당 함수는 컴포넌트가 렌더링되는 시점이 아니라 작성한 dependencies가 바뀌는 시점에만 실행된다.

useEffect의 dependencies를 [] 빈 배열로 지정하면 마운트 시 한 번만 함수 실행
아무것도 넣지 않으면 해당 컴포넌트가 렌더링 될 때마다 함수 실행
dependencies를 넣으면 마운트 시점과 지정한 값이 업데이트 될 때마다 함수 실행

useEffect는 함수를 반환할 수 있는데 이를 cleanup 함수라고 부른다.
cleanup 함수는 컴포넌트가 리렌더링된 이후에 실행된다.

props,state 업데이트 -> 컴포넌트 리렌더링 -> 이전 이펙트 cleanup 함수 실행 -> 새로운 이펙트 실행


---useReducer hook------------------------------------------------------------------------------------------------

useReducer hoook은 보다 복잡한 state를 다룰 때 사용한다.
(ex. 다른 state에 의존적인 state를 업데이트할 때)

const [state, dispatchFn] = useReducer(reducerFn, initialState, initFn);

useReducer는 두 개의 값을 배열로 반환한다.

첫 번째는 가장 최근의 state 스냅샷, 두 번째는 해당 스냅샷을 업데이트할 수 있는 함수

useReducer hook의 인자인 reducerFn은 액션이 발생할 때 리액트에 의해 
자동으로 호출되며 가장 최근의 state 스냅샷을 받고 새롭게 업데이트된 state를 반환한다.











 


